var myObj,initialized=!1,grid;$(document).ready(function(){function e(e,i){var t=s+e;$.ajax({url:t,cache:!0,dataType:"json",success:function(e){return myObj=e,i(e)},error:function(e){console.log("error:",data)}})}function i(e){if(void 0!=e.data&&e.data.length>0){var i=Handlebars.compile($("#moxie-template-movie").html());$("#moxie-control").fadeIn(),$("#moxie-grid").fadeOut(0).html(i(e)).fadeIn(),t()}else $("#moxie-grid").fadeOut(0).html("<p>Sorry, no movies found in the collection</p>").fadeIn()}function t(){void 0!==grid&&(grid.masonry("destroy"),grid.unbind("click")),grid=$(".grid").masonry({itemSelector:".grid-item",columnWidth:160}),grid.on("click",".grid-item",function(){$(this).hasClass("grid-item--gigante")?$(this).find(".card-info").hasClass("active")?($(this).find(".card-info").removeClass("active").fadeOut(50),$(this).find(".card-embed").fadeIn(),r($(this).find(".card-embed"),$(this).data("mdbid"),!0)):($(this).find(".card-info").addClass("active").fadeIn(),$(this).find(".card-embed").fadeOut(50)):(n(),o($(this)),$(".grid-item").removeClass("grid-item--gigante"),$(this).addClass("grid-item--gigante"),grid.masonry("layout"),setTimeout(a.bind(null,$(this)),250))})}function a(e){e.hasClass("grid-item--gigante")&&$("html, body").animate({scrollTop:e.offset().top-50},500)}function o(e){var e=$(e).find(".moxie-player");void 0!==e&&e.length>0&&e[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}function n(){var e=$(".moxie-player");void 0!==e&&e.length>0&&e.each(function(e,i){i.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})}function r(e,i){var t="4b94e36814dcea14914304d5f814330c",a="https://api.themoviedb.org/3/movie/"+i+"/videos?api_key="+t,n=e.find(".moxie-player");return void 0!=n&&n.length>0?void o(n):void 0==i||0==i.length?void e.html("<p>Sorry, there are no related videos</p>"):(e.html("<p>Searching related videos or trailers in themoviedb.org</p>"),void $.ajax({url:a,cache:!0,dataType:"json",success:function(t){var a="<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style><div class='moxie-embed-container' id='player-"+i+"'><iframe class='moxie-player' id='moxie-player-"+i+"' src='http://www.youtube.com/embed/"+t.results[0].key+"?enablejsapi=1&version=3&playerapiid=ytplayer&rel=0&amp;autoplay=1' frameborder='0' width='100%' height='230' allowfullscreen='true' allowscriptaccess='always'></iframe></div>";void 0!==t.results&&t.results.length>0?e.animate().html(a):e.html("<p>Sorry, we found no videos for this movie</p>")},error:function(e){console.log(e)}}))}function d(e,i){var t=[];t.data=myObj.data.filter(function(e){return e.rating>2}),i(t)}var s=moxie_press_vars.endpoint;!function(){var t=Handlebars.compile($("#moxie-template-container").html());$(".moxie_press_container").append(t()),e("",i),$("#filter").click(function(e){e.preventDefault(),d("",i)})}()});