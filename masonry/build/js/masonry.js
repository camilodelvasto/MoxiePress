$(document).ready(function(){function e(e,t){var r=p+e;$.ajax({url:r,cache:!0,dataType:"json",success:function(e){return c=e,t(e)},error:function(e){console.log("error:",data)}})}function t(e){var t=Handlebars.compile($("#moxie-template-movie").html());t(e);$(".moxie-control").fadeIn(50),$("#moxie-grid").css("min-height",$("#moxie-grid").height()),$(".mxp_grid-overlay").show().fadeOut(),$("#moxie-grid").html(t(e)),$("#moxie-grid").prepend('<div class="mxp_grid-sizer"></div>'),i()}function r(){$(".mxp_poster img").each(function(e,t){var r;r=g.width>475?150:$(t).parents(".mxp_poster").width()})}function i(){void 0!==l&&l.masonry("destroy"),r(),l=$(".mxp_grid").masonry({itemSelector:".mxp_grid-item",columnWidth:".mxp_grid-sizer",percentPosition:!0}),o(),$(".mxp_card-trigger-trailer").click(function(e){e.preventDefault();var t=$(this).parents(".mxp_grid-item");t.toggleClass("mxp_card-active"),t.hasClass("mxp_card-active")?(d(t.find(".mxp_card-embed"),t.data("mdbid")),n(t)):s(),l.masonry("layout")}),l.on("click",".mxp_grid-item",function(){var e=$(this);e.hasClass("mxp_grid-item--gigante")||(s(),e.hasClass(".mxp_card-active")&&n(e),$(".mxp_grid-item").removeClass("mxp_grid-item--gigante").removeClass("mxp_card-active"),$(this).addClass("mxp_grid-item--gigante"),l.masonry("layout"),setTimeout(a.bind(null,e),250))})}function o(){$(".mxp_rating-transform").each(function(e,t){for(var r=$(t).html().substr(1,1),i="",o=1;5>=o;o++)r>=o&&(i+="&#9733;");$(t).html(i)})}function a(e){e.hasClass("mxp_grid-item--gigante")&&$("html, body").animate({scrollTop:e.offset().top-50},500)}function n(e){var e=$(e).find(".mxp_moxie-player");void 0!==e&&e.length>0&&e[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}function s(){var e=$(".mxp_moxie-player");void 0!==e&&e.length>0&&e.each(function(e,t){t.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})}function d(e,t){var r="4b94e36814dcea14914304d5f814330c",i="https://api.themoviedb.org/3/movie/"+t+"/videos?api_key="+r,o=e.find(".mxp_moxie-player");return void 0!=o&&o.length>0?void n(o):void 0==t||0==t.length?void e.html("<p>Sorry, there are no related videos</p>"):(e.html("<p>Searching related videos or trailers in themoviedb.org</p>"),void $.ajax({url:i,cache:!0,dataType:"json",success:function(r){var i="<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style><div class='moxie-embed-container' id='player-"+t+"'><iframe class='mxp_moxie-player' id='moxie-player-"+t+"' src='http://www.youtube.com/embed/"+r.results[0].key+"?enablejsapi=1&version=3&playerapiid=ytplayer&rel=0&amp;autoplay=1' frameborder='0' width='100%' height='230' allowfullscreen='true' allowscriptaccess='always'></iframe></div>";void 0!==r.results&&r.results.length>0?e.html(i):e.html("<p>Sorry, we found no videos for this movie</p>")},error:function(e){console.log(e)}}))}function m(e,t,r){var i=[];i.data=c.data.sort(function(r,i){return"asc"==t?i[e]-r[e]:r[e]-i[e]}),r(i)}var c,l,p=moxie_press_vars.endpoint,g=[],u={};!function(){function r(e){$(".mxp_filter").removeClass("active"),e.addClass("active")}u={sort_rating_order:"desc",sort_year_order:"desc",title:"Moxie Press Movie Collection",sort_year_text:"year: ",sort_rating_text:"rating: "},function(){var e=Handlebars.compile($("#moxie-template-container").html()),t=e(u);$(".moxie_press_container").append(t)}(),e("",t),$("#mxp_sort_rating").click(function(e){return e.preventDefault(),m("rating",u.sort_rating_order,t),u.sort_rating_order="desc"==u.sort_rating_order?"asc":"desc",$(this).find("span").html(u.sort_rating_order),r($(this)),!1}),$("#mxp_sort_year").click(function(e){return e.preventDefault(),m("year",u.sort_year_order,t),u.sort_year_order="desc"==u.sort_year_order?"asc":"desc",$(this).find("span").html(u.sort_year_order),r($(this)),!1})}()});